<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#214C69"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex"><meta name="built-on" content="2025-08-28T15:07:24.729565522"><title>Gerenciando Recursos com IDisposable | Learn C#</title><script type="application/json" id="virtual-toc-data">[{"id":"o-problema-vazamento-de-recursos","level":0,"title":"O Problema: Vazamento de Recursos","anchor":"#o-problema-vazamento-de-recursos"},{"id":"a-solu-o-o-padr-o-dispose","level":0,"title":"A Solução: O Padrão Dispose","anchor":"#a-solu-o-o-padr-o-dispose"},{"id":"using-a-forma-segura-e-autom-tica-de-chamar-dispose","level":0,"title":"using: A Forma Segura e Automática de Chamar Dispose","anchor":"#using-a-forma-segura-e-autom-tica-de-chamar-dispose"},{"id":"o-padr-o-dispose-completo-t-pico-avan-ado","level":0,"title":"O Padrão Dispose Completo (Tópico Avançado)","anchor":"#o-padr-o-dispose-completo-t-pico-avan-ado"},{"id":"refer-ncias-oficiais-da-microsoft","level":0,"title":"Referências Oficiais da Microsoft","anchor":"#refer-ncias-oficiais-da-microsoft"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Gerenciando Recursos com IDisposable | Learn C#"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Learn C# Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/using-and-disposing.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Gerenciando Recursos com IDisposable | Learn C#"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/using-and-disposing.html#webpage",
    "url": "writerside-documentation/using-and-disposing.html",
    "name": "Gerenciando Recursos com IDisposable | Learn C#",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/#website",
    "url": "writerside-documentation/",
    "name": "Learn C# Help"
}</script><!-- End Schema.org --></head><body data-id="Using-and-Disposing" data-main-title="Gerenciando Recursos com IDisposable" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="OPP.md|O Paradigma da Programação Orientada a Objetos (POO)"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Learn C#  Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Using-and-Disposing" id="Using-and-Disposing.md">Gerenciando Recursos com IDisposable</h1><p id="-3870ce_3">No universo .NET, o <span class="control" id="-3870ce_12">Garbage Collector (GC)</span>, ou Coletor de Lixo, faz um trabalho fant&aacute;stico de gerenciar a mem&oacute;ria para n&oacute;s. Ele rastreia os objetos que criamos e, quando n&atilde;o est&atilde;o mais em uso, libera automaticamente a mem&oacute;ria que ocupavam. Esses s&atilde;o os chamados <span class="control" id="-3870ce_13">recursos gerenciados</span> (<span class="emphasis" id="-3870ce_14">managed resources</span>).</p><p id="-3870ce_4">No entanto, muitos programas precisam interagir com coisas que est&atilde;o <span class="control" id="-3870ce_15">fora</span> do controle do ambiente .NET. Estes s&atilde;o os <span class="control" id="-3870ce_16">recursos n&atilde;o gerenciados</span> (<span class="emphasis" id="-3870ce_17">unmanaged resources</span>). O Garbage Collector sabe como liberar a mem&oacute;ria de um objeto C#, mas ele n&atilde;o tem ideia de como lidar com esses recursos externos.</p><p id="-3870ce_5">Exemplos comuns de recursos n&atilde;o gerenciados incluem:</p><ul class="list _bullet" id="-3870ce_6"><li class="list__item" id="-3870ce_18"><p id="-3870ce_23"><span class="control" id="-3870ce_24">Conex&otilde;es de banco de dados</span> (<code class="code" id="-3870ce_25">SqlConnection</code>)</p></li><li class="list__item" id="-3870ce_19"><p id="-3870ce_26"><span class="control" id="-3870ce_27">Manipuladores de arquivos</span> (<span class="emphasis" id="-3870ce_28">file handles</span>, como em <code class="code" id="-3870ce_29">FileStream</code>)</p></li><li class="list__item" id="-3870ce_20"><p id="-3870ce_30"><span class="control" id="-3870ce_31">Conex&otilde;es de rede</span> (<code class="code" id="-3870ce_32">Socket</code>)</p></li><li class="list__item" id="-3870ce_21"><p id="-3870ce_33"><span class="control" id="-3870ce_34">Recursos gr&aacute;ficos do sistema operacional</span> (pinc&eacute;is, fontes, janelas)</p></li><li class="list__item" id="-3870ce_22"><p id="-3870ce_35"><span class="control" id="-3870ce_36">Ponteiros para mem&oacute;ria n&atilde;o gerenciada</span></p></li></ul><section class="chapter"><h2 id="o-problema-vazamento-de-recursos" data-toc="o-problema-vazamento-de-recursos">O Problema: Vazamento de Recursos</h2><p id="-3870ce_37">Se voc&ecirc; usa um desses recursos e simplesmente &quot;esquece&quot; o objeto, o GC eventualmente limpar&aacute; a mem&oacute;ria do <span class="emphasis" id="-3870ce_40">objeto C#</span>, mas o recurso externo pode permanecer &quot;preso&quot;. Uma conex&atilde;o de banco de dados pode ficar aberta no servidor, um arquivo pode ficar bloqueado no sistema operacional. Isso &eacute; um <span class="control" id="-3870ce_41">vazamento de recursos</span> (<span class="emphasis" id="-3870ce_42">resource leak</span>) e pode esgotar os recursos do sistema, causando lentid&atilde;o e falhas na aplica&ccedil;&atilde;o.</p><aside class="prompt" data-type="tip" data-title="" id="-3870ce_38"><p id="-3870ce_43"><span class="control" id="-3870ce_44">Disserta&ccedil;&atilde;o</span>: O gerenciamento de recursos n&atilde;o gerenciados &eacute; uma quest&atilde;o de responsabilidade. &Eacute; como alugar um carro. A locadora (o sistema operacional ou o banco de dados) lhe entrega as chaves (o <span class="emphasis" id="-3870ce_45">handle</span> do recurso). Quando voc&ecirc; termina de usar o carro, n&atilde;o pode simplesmente abandon&aacute;-lo na rua e esperar que algu&eacute;m o encontre. Voc&ecirc; tem a responsabilidade de devolv&ecirc;-lo &agrave; locadora para que ele fique dispon&iacute;vel para outros. Se n&atilde;o o fizer, voc&ecirc; est&aacute; bloqueando um recurso valioso. O padr&atilde;o <code class="code" id="-3870ce_46">Dispose</code> &eacute; o processo formal de &quot;devolver as chaves&quot;.</p></aside></section><section class="chapter"><h2 id="a-solu-o-o-padr-o-dispose" data-toc="a-solu-o-o-padr-o-dispose">A Solu&ccedil;&atilde;o: O Padr&atilde;o <code class="code" id="-3870ce_53">Dispose</code></h2><p id="-3870ce_48">Para resolver esse problema, o .NET fornece um contrato simples e poderoso: a interface <code class="code" id="-3870ce_54">IDisposable</code>.</p><div class="code-block" data-lang="csharp">
public interface IDisposable
{
    void Dispose();
}
</div><p id="-3870ce_50">Uma classe que implementa <code class="code" id="-3870ce_55">IDisposable</code> est&aacute; fazendo uma promessa: &quot;Eu gerencio um recurso valioso e finito. Quando voc&ecirc; terminar de me usar, voc&ecirc; <span class="control" id="-3870ce_56">deve</span> chamar meu m&eacute;todo <code class="code" id="-3870ce_57">Dispose()</code> para que eu possa liberar esse recurso de forma segura e imediata.&quot;</p><aside class="prompt" data-type="tip" data-title="" id="-3870ce_51"><p id="-3870ce_58"><span class="control" id="-3870ce_59">Corre&ccedil;&atilde;o de um Mito Comum</span>: O m&eacute;todo <code class="code" id="-3870ce_60">Dispose()</code> <span class="control" id="-3870ce_61">N&Atilde;O</span> destr&oacute;i o objeto .NET. A libera&ccedil;&atilde;o da mem&oacute;ria do objeto em si ainda &eacute; trabalho do Garbage Collector. A &uacute;nica responsabilidade do <code class="code" id="-3870ce_62">Dispose()</code> &eacute; <span class="control" id="-3870ce_63">liberar o recurso n&atilde;o gerenciado</span> (fechar a conex&atilde;o, liberar o arquivo, etc.).</p></aside><section class="chapter"><h3 id="implementando-idisposable" data-toc="implementando-idisposable">Implementando <code class="code" id="-3870ce_68">IDisposable</code></h3><p id="-3870ce_65">Vamos criar uma classe simples que l&ecirc; um arquivo. Ela usar&aacute; um <code class="code" id="-3870ce_69">StreamReader</code>, que &eacute; um tipo <code class="code" id="-3870ce_70">IDisposable</code>.</p><div class="code-block" data-lang="csharp">
// Our class uses an IDisposable resource (_reader), so it must also be IDisposable.
public class SimpleLogReader : IDisposable
{
    private readonly StreamReader _reader;

    public SimpleLogReader(string filePath)
    {
        // We take ownership of the StreamReader
        _reader = new StreamReader(filePath);
        Console.WriteLine(&quot;Log file opened.&quot;);
    }

    public string ReadLine()
    {
        return _reader.ReadLine();
    }

    // This is our implementation of the IDisposable contract.
    public void Dispose()
    {
        // We must release the resource we own.
        _reader?.Dispose();
        Console.WriteLine(&quot;Log file closed.&quot;);
    }
}
</div></section></section><section class="chapter"><h2 id="using-a-forma-segura-e-autom-tica-de-chamar-dispose" data-toc="using-a-forma-segura-e-autom-tica-de-chamar-dispose"><code class="code" id="-3870ce_78">using</code>: A Forma Segura e Autom&aacute;tica de Chamar <code class="code" id="-3870ce_79">Dispose</code></h2><p id="-3870ce_72">O problema de chamar <code class="code" id="-3870ce_80">Dispose()</code> manualmente &eacute; que &eacute; f&aacute;cil esquecer. Pior ainda, se ocorrer uma exce&ccedil;&atilde;o no meio do c&oacute;digo, a chamada ao <code class="code" id="-3870ce_81">Dispose()</code> pode nunca ser alcan&ccedil;ada.</p><p id="-3870ce_73">A solu&ccedil;&atilde;o tradicional para isso &eacute; um bloco <code class="code" id="-3870ce_82">try...finally</code>:</p><div class="code-block" data-lang="csharp">
var logReader = new SimpleLogReader(&quot;activity.log&quot;);
try
{
    Console.WriteLine(logReader.ReadLine());
}
finally
{
    // The finally block is GUARANTEED to execute, even if an exception occurs in the try block.
    logReader.Dispose();
}
</div><p id="-3870ce_75">Isso funciona, mas &eacute; verboso. O C# nos d&aacute; uma sintaxe muito mais limpa e segura para fazer exatamente a mesma coisa: a declara&ccedil;&atilde;o <code class="code" id="-3870ce_83">using</code>.</p><section class="chapter"><h3 id="a-declara-o-using" data-toc="a-declara-o-using">A Declara&ccedil;&atilde;o <code class="code" id="-3870ce_91">using</code></h3><p id="-3870ce_85">A declara&ccedil;&atilde;o <code class="code" id="-3870ce_92">using</code> &eacute; um &quot;a&ccedil;&uacute;car sint&aacute;tico&quot; para o bloco <code class="code" id="-3870ce_93">try...finally</code>. Ela garante que <code class="code" id="-3870ce_94">Dispose()</code> ser&aacute; chamado no objeto assim que o bloco de c&oacute;digo terminar, n&atilde;o importa como.</p><p id="-3870ce_86"><span class="control" id="-3870ce_95">Sintaxe Cl&aacute;ssica (antes do C# 8):</span></p><div class="code-block" data-lang="csharp">
// The using statement defines a scope.
using (var logReader = new SimpleLogReader(&quot;activity.log&quot;))
{
    Console.WriteLine(logReader.ReadLine());
    Console.WriteLine(logReader.ReadLine());
}
// As soon as the code exits this block, logReader.Dispose() is automatically called.
</div><p id="-3870ce_88"><span class="control" id="-3870ce_96">Sintaxe Moderna (C# 8 e superior):</span></p><p id="-3870ce_89">No C# 8, a sintaxe foi simplificada para escopos mais amplos. O <code class="code" id="-3870ce_97">Dispose()</code> &eacute; chamado quando a vari&aacute;vel sai do escopo atual (normalmente, no final do m&eacute;todo).</p><div class="code-block" data-lang="csharp">
public void ProcessLogFile()
{
    // The variable is scoped to the current block (the method).
    using var logReader = new SimpleLogReader(&quot;activity.log&quot;);

    Console.WriteLine(logReader.ReadLine());
    Console.WriteLine(logReader.ReadLine());

} // logReader.Dispose() is automatically called here, at the end of the method.
</div></section><section class="chapter"><h3 id="diagrama-de-sequ-ncia-do-using" data-toc="diagrama-de-sequ-ncia-do-using">Diagrama de Sequ&ecirc;ncia do <code class="code" id="-3870ce_102">using</code></h3><p id="-3870ce_99">Este diagrama mostra o que acontece nos bastidores.</p><style>.theme-dark .plantuml > svg {filter: hue-rotate(180deg) invert(0.9);}div.plantuml {overflow-x: auto;}</style><div class="plantuml"><?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="518px" preserveAspectRatio="none" style="width:453px;height:518px;background:#FFFFFF;" version="1.1" viewBox="0 0 453 518" width="453px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="323.3541" style="stroke:#181818;stroke-width:1.0;" width="10" x="75.5" y="94.0679"/><rect fill="#FFFFFF" height="308.6481" style="stroke:#181818;stroke-width:1.0;" width="10" x="259.5" y="117.7739"/><rect fill="#FFFFFF" height="225.2361" style="stroke:#181818;stroke-width:1.0;" width="10" x="264.5" y="201.186"/><rect fill="#FFFFFF" height="161.8241" style="stroke:#181818;stroke-width:1.0;" width="10" x="269.5" y="264.598"/><rect fill="#FFFFFF" height="51.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="274.5" y="365.716"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="80" x2="80" y1="84.0679" y2="435.4221"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="264" x2="264" y1="84.0679" y2="435.4221"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65" x="45" y="79.9659">UserCode</text><ellipse cx="80.5" cy="13.5" fill="#E3E3E3" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M80.5,21.5 L80.5,48.5 M67.5,29.5 L93.5,29.5 M80.5,48.5 L67.5,63.5 M80.5,48.5 L93.5,63.5 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="65" x="45" y="449.388">UserCode</text><ellipse cx="80.5" cy="461.99" fill="#E3E3E3" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M80.5,469.99 L80.5,496.99 M67.5,477.99 L93.5,477.99 M80.5,496.99 L67.5,511.99 M80.5,496.99 L93.5,511.99 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E3E3E3" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="213" x="158" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199" x="165" y="71.9659">logReader : SimpleLogReader</text><rect fill="#E3E3E3" height="33.0679" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="213" x="158" y="434.4221"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199" x="165" y="456.388">logReader : SimpleLogReader</text><rect fill="#FFFFFF" height="323.3541" style="stroke:#181818;stroke-width:1.0;" width="10" x="75.5" y="94.0679"/><rect fill="#FFFFFF" height="308.6481" style="stroke:#181818;stroke-width:1.0;" width="10" x="259.5" y="117.7739"/><rect fill="#FFFFFF" height="225.2361" style="stroke:#181818;stroke-width:1.0;" width="10" x="264.5" y="201.186"/><rect fill="#FFFFFF" height="161.8241" style="stroke:#181818;stroke-width:1.0;" width="10" x="269.5" y="264.598"/><rect fill="#FFFFFF" height="51.706" style="stroke:#181818;stroke-width:1.0;" width="10" x="274.5" y="365.716"/><polygon fill="#181818" points="247.5,113.7739,257.5,117.7739,247.5,121.7739,251.5,117.7739" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.5" x2="253.5" y1="117.7739" y2="117.7739"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="92.5" y="111.9649">new(filePath)</text><polygon fill="#181818" points="96.5,127.7739,86.5,131.7739,96.5,135.7739,92.5,131.7739" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.5" x2="258.5" y1="131.7739" y2="131.7739"/><path d="M5,144.7739 L5,171.7739 L157,171.7739 L157,154.7739 L147,144.7739 L5,144.7739 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M147,144.7739 L147,154.7739 L157,154.7739 L147,144.7739 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="11" y="163.6709">In&#237;cio do bloco `using`</text><polygon fill="#181818" points="252.5,197.186,262.5,201.186,252.5,205.186,256.5,201.186" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.5" x2="258.5" y1="201.186" y2="201.186"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="92.5" y="195.377">ReadLine()</text><polygon fill="#181818" points="96.5,228.892,86.5,232.892,96.5,236.892,92.5,232.892" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.5" x2="263.5" y1="232.892" y2="232.892"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="102.5" y="227.083">Retorna linha</text><polygon fill="#181818" points="257.5,260.598,267.5,264.598,257.5,268.598,261.5,264.598" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.5" x2="263.5" y1="264.598" y2="264.598"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="92.5" y="258.789">ReadLine()</text><polygon fill="#181818" points="96.5,292.304,86.5,296.304,96.5,300.304,92.5,296.304" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="90.5" x2="268.5" y1="296.304" y2="296.304"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="102.5" y="290.495">Retorna linha</text><path d="M9,309.304 L9,336.304 L151,336.304 L151,319.304 L141,309.304 L9,309.304 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M141,309.304 L141,319.304 L151,319.304 L141,309.304 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="15" y="328.201">Fim do bloco `using`</text><polygon fill="#181818" points="262.5,361.716,272.5,365.716,262.5,369.716,266.5,365.716" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="85.5" x2="268.5" y1="365.716" y2="365.716"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="92.5" y="359.907">Dispose() [AUTOM&#193;TICO]</text><path d="M289,378.716 L289,405.716 L446,405.716 L446,388.716 L436,378.716 L289,378.716 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><path d="M436,378.716 L436,388.716 L446,388.716 L436,378.716 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="295" y="397.6131">Libera o StreamReader</text><polygon fill="#181818" points="91.5,413.4221,81.5,417.4221,91.5,421.4221,87.5,417.4221" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="85.5" x2="268.5" y1="417.4221" y2="417.4221"/><!--SRC=[jP3FIWD13CRlynIXfthe2-n1a8fGMAdOzYH2qvtiRd1ciinCsxCFv5FqnHpN_IDQf9VUGl9zloz9U6FNe4SBLfmKjHTB4FsUL1WceKOjHtOLb6W2AOL550-RG7ukcbHIHIwuGHTXOgHw9jJa8OCLsyPGtdScW06-ovR11umqOle2PhSm81mTfoKRUi9OtuocZjB9PianO9IJ9903ZHjci72dZu85jC3EI26mtOTqq5QTJ_qgSdOqlIYoDQIFE0J3hiOhGS_TzS3sqflkEJGIKZgyt6tMoyVJ-tenNxx-sQMDyLpL4QJicXdal2EF8B2Adj3-ytzDlua_Mxti4m00]--></g></svg></div></section></section><section class="chapter"><h2 id="o-padr-o-dispose-completo-t-pico-avan-ado" data-toc="o-padr-o-dispose-completo-t-pico-avan-ado">O Padr&atilde;o <code class="code" id="-3870ce_109">Dispose</code> Completo (T&oacute;pico Avan&ccedil;ado)</h2><p id="-3870ce_104">E se um desenvolvedor esquecer de usar o <code class="code" id="-3870ce_110">using</code>? O recurso ainda vazaria. Para criar uma rede de seguran&ccedil;a, existe um padr&atilde;o mais robusto que usa um <span class="control" id="-3870ce_111">Finalizador</span> (tamb&eacute;m conhecido como destrutor).</p><p id="-3870ce_105">Um finalizador (<code class="code" id="-3870ce_112">~NomeDaClasse()</code>) &eacute; um m&eacute;todo especial que o Garbage Collector chama em algum momento no futuro, antes de liberar a mem&oacute;ria de um objeto. Ele serve como um &uacute;ltimo recurso para liberar recursos n&atilde;o gerenciados.</p><aside class="prompt" data-type="tip" data-title="" id="-3870ce_106"><p id="-3870ce_113"><span class="control" id="-3870ce_114">Nota</span>: Voc&ecirc; s&oacute; precisa deste padr&atilde;o complexo se sua classe possui <span class="control" id="-3870ce_115">diretamente</span> recursos n&atilde;o gerenciados (como ponteiros de mem&oacute;ria). Se sua classe apenas cont&eacute;m <span class="control" id="-3870ce_116">outros objetos gerenciados</span> que s&atilde;o <code class="code" id="-3870ce_117">IDisposable</code> (como <code class="code" id="-3870ce_118">FileStream</code> ou <code class="code" id="-3870ce_119">SqlConnection</code>), a implementa&ccedil;&atilde;o simples mostrada anteriormente &eacute; geralmente suficiente.</p></aside><div class="code-block" data-lang="csharp">
public class RobustResourceHolder : IDisposable
{
    private bool _disposed = false; // To prevent redundant calls

    // Constructor
    public RobustResourceHolder()
    {
        // Allocate unmanaged resources here (e.g., memory pointers)
    }

    // The public Dispose method, called by the user.
    public void Dispose()
    {
        // Dispose of both managed and unmanaged resources.
        Dispose(true);
        // Take this object off the finalization queue to prevent finalization code for this object
        // from executing a second time.
        GC.SuppressFinalize(this);
    }

    // The protected virtual method that does the actual work.
    protected virtual void Dispose(bool disposing)
    {
        if (_disposed) return;

        if (disposing)
        {
            // Called from Dispose(). It is safe to dispose managed resources here.
            // e.g., myManagedResource.Dispose();
        }

        // Always dispose unmanaged resources here.
        // e.g., FreeTheUnmanagedMemoryPointer();

        _disposed = true;
    }

    // The finalizer (destructor), called by the GC as a safety net.
    ~RobustResourceHolder()
    {
        // Do not dispose managed resources here, because the GC may have already finalized them.
        // Only dispose unmanaged resources.
        Dispose(false);
    }
}
</div></section><section class="chapter"><h2 id="refer-ncias-oficiais-da-microsoft" data-toc="refer-ncias-oficiais-da-microsoft">Refer&ecirc;ncias Oficiais da Microsoft</h2><ul class="list _bullet" id="-3870ce_120"><li class="list__item" id="-3870ce_121"><p id="-3870ce_124"><a href="https://learn.microsoft.com/pt-br/dotnet/standard/garbage-collection/implementing-dispose" id="-3870ce_125" data-external="true" rel="noopener noreferrer" target="_blank">Implementar um m&eacute;todo Dispose (Guia de Programa&ccedil;&atilde;o C#)</a></p></li><li class="list__item" id="-3870ce_122"><p id="-3870ce_126"><a href="https://learn.microsoft.com/pt-br/dotnet/csharp/language-reference/statements/using" id="-3870ce_127" data-external="true" rel="noopener noreferrer" target="_blank">Instru&ccedil;&atilde;o <code class="code" id="-3870ce_128">using</code> (Refer&ecirc;ncia de C#)</a></p></li><li class="list__item" id="-3870ce_123"><p id="-3870ce_129"><a href="https://learn.microsoft.com/pt-br/dotnet/api/system.idisposable" id="-3870ce_130" data-external="true" rel="noopener noreferrer" target="_blank">Interface <code class="code" id="-3870ce_131">IDisposable</code></a></p></li></ul></section><div class="last-modified">28 August 2025</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="complextypes.html" class="navigation-links__prev">Tipos Complexos</a><a href="references.html" class="navigation-links__next">References</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.22.0-b776/app.js"></script></body></html>